<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="google-adsense-account" content="ca-pub-9045897537899876">
    
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
        integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="./CSS/index.css" />
</head>

<body>
    <div class="navbar">
        <div class="nav-left">
            <label class="checkbtn" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </label>
            <label class="logo">BOOK WEB</label>
        </div>

        <ul id="menu-list">
            <li><a href="./index.html">Home</a></li>
            <li><a href="./HTML/help.html">Help</a></li>
            <li><a href="#">My Books</a></li>
            <li><a href="./HTML/about us.html">About Us</a></li>
            <li><a href="./HTML/contact us.html">Contact Us</a></li>
            <li id="logoutLi" style="display: none;">
        <a href="javascript:void(0)" onclick="logoutUser()" style="color: red; font-weight: bold;">Logout</a>
    </li>
        </ul>

        <div class="navbar-right">
            <a href="javascript:void(0)"><i class="fa-solid fa-magnifying-glass"></i></a>
            <div id="profileIcon"><i class="fa-solid fa-circle-user"></i></div>
        </div>
    </div>


    <h1 style="padding-top: 10px;">Select your class</h1>
    <div class="container">

        <a href="">
            <div class="box">class 9</div>
        </a>
        <a href="#">
            <div class="box">Class 10</div>
        </a>
        <a href="#">
            <div class="box">Class 11</div>
        </a>
        <a href="#">
            <div class="box">Class 12</div>
        </a>
        <a href="#">
            <div class="box">Diploma CSE</div>

        </a>

    </div><br>
    <a href="./HTML/upload book.html">
        <button class="upload-btn">Upload Book</button>
    </a>


    <div class="features">
        <div class="feature">
            <h1>Features books</h1>
        </div>
        <br>
        <div class="books"> 
            <div class="book">
                <div class="books">
                <h3>Loading books...</h3>
                </div> 
                <div><img src="./IMAGES/physics.jpg" alt="book1" />
                    <h3>Physics</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>

            </div>

            <div class="book">
                <div><img src="./IMAGES/Chemistry.jpg" alt="book1" />
                    <h3>Chemistry</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/bio.jpg" alt="book2" />
                    <h3>Biology</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/maths.jpg" alt="book3" />
                    <h3>Maths</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/python.jpg" alt="book4" />
                    <h3>Pythoon</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>



            </div>

        </div>






    </div>

    <div class="features">
        <div class="books">





            <div class="book">
                <div><img src="./IMAGES/java.jpg" alt="book1" />
                    <h3>Java</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>

            </div>
            <div class="book">
                <div><img src="./IMAGES/js.jpg" alt="book1" />
                    <h3>JavaScript</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/c.jpg" alt="book2" />
                    <h3>C Programming</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/html.jpg" alt="book3" />
                    <h3>HTML</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>
            <div class="book">
                <div><img src="./IMAGES/c++.jpg" alt="book4" />
                    <h3> C++</h3>
                    <p>Author:R.D.Sharma</p>
                    <button><a href="./HTML/Exchange.html">Exchange</a></button>
                </div>
            </div>

        </div>
    </div> 



    <footer>
        <div class="footer-container">

            <div class="footer-box">
                <h3>About Us</h3>
                <p>We are a student-driven online platform that allows you to exchange books easily and affordably.
                    Reduce waste, share knowledge, and connect with readers.</p>
            </div>

            <div class="footer-box">
                <h3>Quick Links</h3>
                <a href="#">Home</a><br>
                <a href="#">Browse Books</a><br>
                <a href="#">Post a Book</a><br>
                <a href="#">Login / Register</a>

            </div>

            <div class="footer-box">
                <h3>Contact Info</h3>
                <p>Email: support@bookexchange.com</p>
                <p>Phone: +91-9876543210</p>
                <p>Address: Patna,Bihar, India</p>
            </div>
            <div class="footer-box">
                <h3>Follow Us</h3>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-facebook"></i>Facebook</a><br>
                    <a href="#"><i class="fab fa-twitter"></i>Twitter</a><br>
                    <a href="#"><i class="fab fa-instagram"></i>Instagram</a><br>
                    <a href="#"><i class="fab fa-linkedin"></i>Linkedin</a>
                </div>
            </div>


        </div>

        <div class="footer-bottom">
            annajxbcndbscnscdsbjka
        </div>
    </footer>

   <script>
    // 1. Navbar Toggle
    document.getElementById("menu-toggle").addEventListener("click", function () {
        document.getElementById("menu-list").classList.toggle("show");
    });

    // üåü GLOBAL VARIABLE: Isme hum saari books save karenge
    let allBooks = [];

     
    // ‚úÖ LOGOUT FUNCTION (Isse bahar rakhna zaroori hai taaki HTML isse dhoond sake)
    function logoutUser() {
        if (confirm("Are you sure you want to logout?")) {
            localStorage.removeItem("user"); // Data hatao
            alert("‚úÖ Logged out successfully!");
            window.location.reload(); // Refresh karo
        }
    }

    // 2. Page Load hone par
    window.addEventListener("DOMContentLoaded", async () => {
        
        // --- User Profile & Logout Logic ---
        const userData = localStorage.getItem("user");
        const profileIcon = document.getElementById("profileIcon");
        const logoutBtn = document.getElementById("logoutLi"); 

        if (userData) {
            // Agar User Login hai:
            const user = JSON.parse(userData);
            
            // 1. Profile Icon update
            const firstLetter = user.name.charAt(0).toUpperCase();
            profileIcon.innerHTML = `<div class="profile-circle" id="profileLetter" style="width:35px; height:35px; background:#ff5722; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:bold; cursor:pointer;">${firstLetter}</div>`;
            
            // 2. Profile click alert
            document.getElementById("profileLetter").addEventListener("click", () => {
                alert(`User: ${user.name}\nMobile: ${user.mobileno || user.mobile}\nEmail: ${user.email}`);
            });

            // 3. Logout Button dikhao
            if (logoutBtn) logoutBtn.style.display = "block";

        } else {
            // Agar User Login NAHI hai:
            profileIcon.addEventListener("click", () => window.location.href = "./HTML/home.html");
            
            // Logout button chupao
            if (logoutBtn) logoutBtn.style.display = "none";
        }
        // --- FETCH BOOKS ---
        const backendURL = "https://bookweb-backend-vu2o.onrender.com";
        const booksContainer = document.querySelector(".features .books");

        try {
            // Loading text
            booksContainer.innerHTML = "<h3 style='text-align:center; color:blue;'>‚è≥ Loading books...</h3>";

            const response = await fetch(backendURL + "/books");
            if (!response.ok) throw new Error("Server Error");

            // ‚úÖ STEP A: Data ko global variable me save kar lo
            allBooks = await response.json(); 

            // ‚úÖ STEP B: Pehli baar saari books dikhao
            renderBooks(allBooks); 

        } catch (error) {
            console.error("Error:", error);
            booksContainer.innerHTML = "<h3 style='color:red; text-align:center;'>‚ùå Server Error (Try refreshing)</h3>";
        }
    });

    // üåü FUNCTION: Books ko screen par dikhane ke liye
    // Ye function hum search karte waqt bhi use karenge
    function renderBooks(booksList) {
        const booksContainer = document.querySelector(".features .books");
        booksContainer.innerHTML = ""; // Purana data saaf karo

        // Agar search karne par koi book na mile
        if (booksList.length === 0) {
            booksContainer.innerHTML = "<h3 style='text-align:center;'>No books found matching your search.</h3>";
            return;
        }

        booksList.forEach(book => {
            const bookDiv = document.createElement("div");
            bookDiv.classList.add("book");

            // Image Logic (Naam ke hisaab se photo)
            let imagePath = "./IMAGES/physics.jpg"; // Default
            let name = (book.bookname || "").toLowerCase();
            
            if (name.includes("math")) imagePath = "./IMAGES/maths.jpg";
            else if (name.includes("chem")) imagePath = "./IMAGES/Chemistry.jpg";
            else if (name.includes("java")) imagePath = "./IMAGES/java.jpg";
            else if (name.includes("python")) imagePath = "./IMAGES/python.jpg";
            else if (name.includes("html")) imagePath = "./IMAGES/html.jpg";
            else if (name.includes("bio")) imagePath = "./IMAGES/bio.jpg";
            else if (name.includes("c++")) imagePath = "./IMAGES/c++.jpg";

            bookDiv.innerHTML = `
                <div>
                    <img src="${imagePath}" alt="book" style="width:100%; height:200px; object-fit:cover;" />
                    <h3>${book.bookname}</h3>
                    <p>Author: ${book.bookauthor}</p>
                    <p>Price: ‚Çπ${book.bookprice}</p>
                    <a href="./HTML/Exchange.html?id=${book._id}">
                        <button style="cursor:pointer;">Exchange</button>
                    </a>
                </div>
            `;
            booksContainer.appendChild(bookDiv);
        });
    }

    // --- 3. SEARCH BOX LOGIC ---
    const searchIcon = document.querySelector(".navbar-right a i.fa-magnifying-glass");
    const navbarRight = document.querySelector(".navbar-right");

    const searchInput = document.createElement("input");
    searchInput.type = "text";
    searchInput.placeholder = "Search books...";
    searchInput.style.cssText = `width: 0; padding: 5px 10px; border: 1px rgb(114, 60, 60); border-radius: 20px; outline: none; transition: width 0.3s ease, padding 0.3s ease; margin-left: 10px; display: inline-block; background: transparent;`;
    navbarRight.appendChild(searchInput);

    // Click par search box khulega
    searchIcon.addEventListener("click", (e) => {
        e.stopPropagation();
        if (searchInput.style.width === "0px" || searchInput.style.width === "") {
            searchInput.style.width = "200px";
            searchInput.style.padding = "5px 10px";
            searchInput.focus();
            searchInput.style.background = "white";
            searchInput.style.border = "1px solid black";
        } else {
            searchInput.style.width = "0";
            searchInput.style.padding = "0";
        }
    });

    // üåü MAIN SEARCH LOGIC: Type karte hi filter karega
    searchInput.addEventListener("input", (e) => {
        const searchText = e.target.value.toLowerCase(); // User ne jo type kiya (small letters me)

        // Filter: Sirf wo books rakho jinka naam ya author match kare
        const filteredBooks = allBooks.filter(book => {
            const bookName = (book.bookname || "").toLowerCase();
            const authorName = (book.bookauthor || "").toLowerCase();
            
            return bookName.includes(searchText) || authorName.includes(searchText);
        });

        // Ab sirf filtered books dikhao
        renderBooks(filteredBooks);
    });

    // Bahar click karne par search box band
    document.addEventListener("click", (e) => {
        if (e.target !== searchIcon && e.target !== searchInput) {
            searchInput.style.width = "0";
            searchInput.style.padding = "0";
        }
    });

</script>
</body>

</html>
